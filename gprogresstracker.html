<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GATE 2026 Progress Tracker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body.dark-mode {
      background-color: #1f2937;
      color: #f3f4f6;
    }
    body.dark-mode .bg-white {
      background-color: #374151;
    }
    body.dark-mode .bg-gray-100 {
      background-color: #1f2937;
    }
    body.dark-mode .bg-gray-200 {
      background-color: #4b5563;
    }
    body.dark-mode .bg-blue-100 {
      background-color: #1e40af;
    }
    body.dark-mode .bg-green-100 {
      background-color: #166534;
    }
    body.dark-mode .bg-yellow-100 {
      background-color: #854d0e;
    }
    body.dark-mode .text-blue-600 {
      color: #60a5fa;
    }
    body.dark-mode .text-green-600 {
      color: #4ade80;
    }
    body.dark-mode .text-yellow-600 {
      color: #fbbf24;
    }
    body.dark-mode .border {
      border-color: #4b5563;
    }
    body.dark-mode input,
    body.dark-mode select,
    body.dark-mode textarea {
      background-color: #4b5563;
      color: #f3f4f6;
      border-color: #6b7280;
    }
    body.dark-mode .hover\:bg-blue-700:hover {
      background-color: #1d4ed8;
    }
    body.dark-mode .hover\:bg-red-700:hover {
      background-color: #b91c1c;
    }
    body.dark-mode .text-red-600 {
      color: #f87171;
    }
    .topic-table {
      max-height: 400px;
      overflow-y: auto;
    }
    textarea {
      resize: none;
    }
    .chart-container {
      max-width: 200px;
      margin: 0 auto;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      width: 90%;
      max-width: 500px;
    }
    body.dark-mode .modal-content {
      background-color: #374151;
      color: #f3f4f6;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center p-4">
  <!-- Paper Selection Modal -->
  <div id="paperModal" class="modal">
    <div class="modal-content">
      <h2 class="text-xl font-semibold mb-4">Select GATE 2026 Papers</h2>
      <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Number of Papers</label>
        <select id="numPapers" class="mt-1 p-2 w-full border rounded-md" onchange="togglePaperInputs()">
          <option value="1">1 Paper</option>
          <option value="2">2 Papers</option>
        </select>
      </div>
      <div id="paper1Input" class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Primary Paper</label>
        <select id="paper1" class="mt-1 p-2 w-full border rounded-md"></select>
      </div>
      <div id="paper2Input" class="mb-4 hidden">
        <label class="block text-sm font-medium text-gray-700">Secondary Paper</label>
        <select id="paper2" class="mt-1 p-2 w-full border rounded-md"></select>
      </div>
      <button onclick="savePaperSelection()" class="w-full bg-blue-600 text-white p-2 rounded-md hover:bg-blue-700">Save Selection</button>
    </div>
  </div>
  <!-- Main Tracker -->
  <div class="w-full max-w-5xl bg-white rounded-lg shadow-lg p-6">
    <div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
      <h1 id="trackerTitle" class="text-2xl sm:text-3xl font-bold text-blue-600">GATE 2026 Progress Tracker</h1>
      <div class="flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-4">
        <button id="darkModeButton" onclick="toggleDarkMode()" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 w-full sm:w-auto">Toggle Night Mode</button>
        <button onclick="initiateReset()" class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 w-full sm:w-auto">Reset All Data</button>
      </div>
    </div>
    <!-- Progress Summary -->
    <div class="mb-8">
      <h2 class="text-xl font-semibold mb-4">Progress Summary</h2>
      <div id="progressSummary" class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-4"></div>
      <div id="chartContainer" class="grid grid-cols-1 sm:grid-cols-3 gap-4"></div>
    </div>
    <!-- Topic List -->
    <div id="topicList" class="mb-8">
      <h2 class="text-xl font-semibold mb-4">Syllabus Topics</h2>
      <div id="topicTables" class="space-y-6"></div>
    </div>
    <!-- Task Input Form -->
    <div class="mb-8">
      <h2 class="text-xl font-semibold mb-4">Add Daily Task/Notes</h2>
      <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
        <div>
          <label class="block text-sm font-medium text-gray-700">Date</label>
          <input type="date" id="taskDate" class="mt-1 p-2 w-full border rounded-md" value="">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Subject</label>
          <select id="subject" class="mt-1 p-2 w-full border rounded-md"></select>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Topic</label>
          <input type="text" id="topic" class="mt-1 p-2 w-full border rounded-md" placeholder="e.g., Linear Algebra, Python">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Completion Status</label>
          <select id="status" class="mt-1 p-2 w-full border rounded-md">
            <option value="Not Started">Not Started</option>
            <option value="In Progress">In Progress</option>
            <option value="Completed">Completed</option>
          </select>
        </div>
        <div class="sm:col-span-2">
          <label class="block text-sm font-medium text-gray-700">Notes</label>
          <textarea id="notes" class="mt-1 p-2 w-full border rounded-md" rows="4" placeholder="e.g., Struggled with FFT, need to revise"></textarea>
        </div>
        <div class="sm:col-span-2">
          <button onclick="addTask()" class="w-full bg-blue-600 text-white p-2 rounded-md hover:bg-blue-700">Add Task</button>
        </div>
      </div>
    </div>
    <!-- Task History -->
    <div>
      <h2 class="text-xl font-semibold mb-4">Task History</h2>
      <div class="topic-table">
        <table class="w-full border-collapse">
          <thead>
            <tr class="bg-gray-200">
              <th class="border p-2">Date</th>
              <th class="border p-2">Subject</th>
              <th class="border p-2">Topic</th>
              <th class="border p-2">Status</th>
              <th class="border p-2">Notes</th>
              <th class="border p-2">Actions</th>
            </tr>
          </thead>
          <tbody id="taskTable"></tbody>
        </table>
      </div>
    </div>
  </div>
  <script>
    // Comprehensive syllabus for all 30 GATE 2026 papers
    const syllabus = {
      AE: [
        "Flight Mechanics: Atmosphere, Airplane Performance",
        "Aerodynamics: Airfoils, Lift, Drag",
        "Structures: Stress-Strain, Flight Vehicle Structures",
        "Propulsion: Gas Turbines, Rocket Propulsion",
        "Space Dynamics: Orbital Mechanics",
        "Engineering Mathematics: Linear Algebra, Calculus, Differential Equations"
      ],
      AG: [
        "Farm Machinery: Design, Operation",
        "Soil and Water Conservation: Irrigation, Drainage",
        "Agricultural Processing: Drying, Milling",
        "Farm Power: Engines, Tractors",
        "Engineering Mathematics: Linear Algebra, Calculus"
      ],
      AR: [
        "Architecture: History, Design",
        "Planning: Urban, Regional",
        "Building Materials and Construction",
        "Environmental Planning: Sustainability",
        "Infrastructure: Transport, Water Supply"
      ],
      BM: [
        "Human Anatomy and Physiology",
        "Biomedical Instrumentation: Sensors, Amplifiers",
        "Biomechanics: Kinematics, Kinetics",
        "Medical Imaging: X-Ray, MRI",
        "Biomaterials",
        "Engineering Mathematics: Linear Algebra, Probability"
      ],
      BT: [
        "Biochemistry: Enzymes, Metabolism",
        "Microbiology: Microbial Genetics",
        "Molecular Biology: DNA, RNA",
        "Bioprocess Engineering: Fermentation",
        "Immunology",
        "Engineering Mathematics: Calculus, Numerical Methods"
      ],
      CE: [
        "Structural Engineering: Beams, Columns",
        "Geotechnical Engineering: Soil Mechanics",
        "Water Resources: Hydrology, Irrigation",
        "Transportation Engineering: Highways, Traffic",
        "Environmental Engineering: Water Treatment",
        "Engineering Mathematics: Linear Algebra, Calculus"
      ],
      CH: [
        "Chemical Reaction Engineering: Kinetics, Reactors",
        "Process Calculations: Material Balance",
        "Fluid Mechanics: Flow, Pumps",
        "Heat Transfer: Conduction, Convection",
        "Mass Transfer: Distillation, Absorption",
        "Engineering Mathematics: Differential Equations"
      ],
      CS: [
        "Algorithms: Sorting, Graph Algorithms",
        "Data Structures: Arrays, Trees",
        "Operating Systems: Processes, Memory Management",
        "Databases: SQL, Normalization",
        "Computer Networks: OSI, TCP/IP",
        "Engineering Mathematics: Discrete Math, Probability"
      ],
      CY: [
        "Physical Chemistry: Thermodynamics, Kinetics",
        "Inorganic Chemistry: Coordination Compounds",
        "Organic Chemistry: Reaction Mechanisms",
        "Analytical Chemistry: Spectroscopy",
        "Quantum Chemistry"
      ],
      DA: [
        "Probability and Statistics: Distributions, Hypothesis Testing",
        "Linear Algebra: Matrices, Eigenvalues",
        "Calculus: Optimization, Partial Derivatives",
        "Programming: Python, Data Structures",
        "Machine Learning: Regression, Classification",
        "Data Visualization: Plots, Charts"
      ],
      EC: [
        "Engineering Mathematics: Linear Algebra, Calculus, Probability",
        "Networks: KCL, KVL, Thevenin",
        "Signals and Systems: Fourier, Laplace, Z-Transform",
        "Electronic Devices: Semiconductors, Diodes",
        "Analog Circuits: Amplifiers, Oscillators",
        "Digital Circuits: Logic Gates, Microprocessors",
        "Control Systems: Stability, Bode Plots",
        "Communications: AM, FM, Digital Modulation",
        "Electromagnetics: Maxwell’s Equations, Antennas"
      ],
      EE: [
        "Electric Circuits: KCL, KVL, AC Analysis",
        "Electromagnetic Fields: Maxwell’s Equations",
        "Signals and Systems: Fourier, Laplace",
        "Electrical Machines: Transformers, Motors",
        "Power Systems: Load Flow, Fault Analysis",
        "Engineering Mathematics: Linear Algebra, Probability"
      ],
      ES: [
        "Environmental Chemistry: Pollutants",
        "Water and Wastewater Treatment",
        "Air Pollution: Control Technologies",
        "Solid Waste Management",
        "Environmental Laws",
        "Mathematics: Linear Algebra, Statistics"
      ],
      EY: [
        "Ecology: Ecosystems, Biodiversity",
        "Evolution: Natural Selection, Genetics",
        "Behavioral Ecology",
        "Conservation Biology",
        "Quantitative Ecology: Statistics"
      ],
      GE: [
        "Surveying: Levelling, Triangulation",
        "Remote Sensing: GIS, GPS",
        "Photogrammetry",
        "Geodesy",
        "Mathematics: Numerical Methods"
      ],
      GG: [
        "Geology: Mineralogy, Petrology",
        "Geophysics: Seismic, Gravity",
        "Structural Geology",
        "Hydrogeology",
        "Mathematics: Statistics"
      ],
      IN: [
        "Electrical Circuits: Network Analysis",
        "Analog Electronics: Amplifiers",
        "Digital Electronics: Microcontrollers",
        "Signals and Systems: Transforms",
        "Sensors and Transducers",
        "Engineering Mathematics: Linear Algebra, Calculus"
      ],
      MA: [
        "Linear Algebra: Vector Spaces, Eigenvalues",
        "Calculus: Multivariable, Series",
        "Differential Equations: ODE, PDE",
        "Complex Analysis",
        "Probability and Statistics",
        "Numerical Analysis"
      ],
      ME: [
        "Mechanics: Statics, Dynamics",
        "Thermodynamics: Laws, Cycles",
        "Fluid Mechanics: Flow, Bernoulli",
        "Heat Transfer: Conduction, Convection",
        "Manufacturing: Machining, Welding",
        "Engineering Mathematics: Linear Algebra, Calculus"
      ],
      MN: [
        "Mine Development: Drilling, Blasting",
        "Mine Ventilation",
        "Mine Safety",
        "Rock Mechanics",
        "Mineral Economics",
        "Mathematics: Numerical Methods"
      ],
      MT: [
        "Physical Metallurgy: Phase Diagrams",
        "Mechanical Metallurgy: Stress-Strain",
        "Extractive Metallurgy: Pyrometallurgy",
        "Materials Characterization",
        "Corrosion",
        "Mathematics: Differential Equations"
      ],
      NM: [
        "Ship Design: Stability, Hydrodynamics",
        "Marine Structures: Strength",
        "Marine Propulsion",
        "Ocean Engineering",
        "Mathematics: Calculus, Numerical Methods"
      ],
      PE: [
        "Petroleum Formation: Geology",
        "Drilling Technology",
        "Reservoir Engineering",
        "Production Operations",
        "Refining Processes",
        "Mathematics: Differential Equations"
      ],
      PH: [
        "Classical Mechanics: Lagrangian, Hamiltonian",
        "Quantum Mechanics: Wave Functions",
        "Electromagnetism: Maxwell’s Equations",
        "Thermodynamics: Statistical Mechanics",
        "Solid State Physics",
        "Mathematical Physics"
      ],
      PI: [
        "Manufacturing Processes: Casting, Forming",
        "Industrial Engineering: Optimization",
        "Metrology: Measurement Systems",
        "Production Planning: Scheduling",
        "Quality Control",
        "Engineering Mathematics: Linear Algebra"
      ],
      ST: [
        "Probability: Distributions, Expectation",
        "Statistical Inference: Hypothesis Testing",
        "Regression Analysis",
        "Multivariate Analysis",
        "Stochastic Processes"
      ],
      TF: [
        "Textile Fibres: Natural, Synthetic",
        "Yarn Manufacture: Spinning",
        "Fabric Manufacture: Weaving, Knitting",
        "Textile Testing",
        "Chemical Processing",
        "Mathematics: Statistics"
      ],
      XE: [
        "Engineering Mathematics: Linear Algebra, Calculus",
        "Fluid Mechanics: Flow, Viscosity",
        "Materials Science: Properties, Composites",
        "Thermodynamics: Laws, Cycles",
        "Solid Mechanics: Stress, Strain",
        "Polymer Science: Synthesis",
        "Food Technology",
        "Energy Science: Renewable Energy"
      ],
      XH: [
        "Reasoning and Comprehension",
        "Economics: Micro, Macro",
        "English: Literature, Criticism",
        "Linguistics: Phonetics, Syntax",
        "Philosophy: Ethics, Logic",
        "Psychology: Cognitive, Social",
        "Sociology: Social Theory"
      ],
      XL: [
        "Chemistry: Organic, Inorganic",
        "Biochemistry: Enzymes, Metabolism",
        "Botany: Plant Physiology",
        "Microbiology: Microbial Genetics",
        "Zoology: Animal Physiology",
        "Food Technology"
      ],
      GA: [
        "Quantitative Aptitude: Ratios, Percentages",
        "Data Interpretation: Tables, Graphs",
        "Logical Reasoning: Puzzles, Syllogisms",
        "Verbal Ability: Reading Comprehension",
        "Vocabulary: Synonyms, Antonyms"
      ]
    };
    // Allowed two-paper combinations
    const allowedCombinations = {
      AE: ['CE', 'ME', 'XE'],
      AG: ['CE'],
      AR: ['CE', 'GE'],
      BM: ['BT', 'IN'],
      BT: ['BM', 'XL'],
      CE: ['AE', 'AG', 'AR', 'ES', 'GE', 'NM', 'XE'],
      CH: ['ES', 'PE', 'XE'],
      CS: ['DA', 'EC', 'GE', 'MA', 'PH', 'ST'],
      CY: ['XE', 'XL'],
      DA: ['CS', 'EC', 'EE', 'MA', 'ME', 'PH', 'ST', 'XE'],
      EC: ['CS', 'DA', 'EE', 'IN', 'PH'],
      EE: ['DA', 'EC', 'IN', 'PH'],
      ES: ['CE', 'CH', 'GE'],
      EY: ['XL'],
      GE: ['AR', 'CE', 'CS', 'ES', 'GG'],
      GG: ['GE'],
      IN: ['BM', 'EC', 'EE', 'ME'],
      MA: ['CS', 'DA', 'PH', 'ST'],
      ME: ['AE', 'DA', 'IN', 'NM', 'PI', 'XE'],
      MN: [],
      MT: ['XE'],
      NM: ['CE', 'ME'],
      PE: ['CH'],
      PH: ['CS', 'DA', 'EC', 'EE', 'MA', 'XE'],
      PI: ['ME', 'XE'],
      ST: ['CS', 'DA', 'MA', 'XH'],
      TF: [],
      XE: ['AE', 'CE', 'CH', 'CY', 'DA', 'ME', 'MT', 'PH', 'PI'],
      XH: ['ST'],
      XL: ['BT', 'CY', 'EY']
    };
    // Common topics across papers
    const commonTopics = [
      "Linear Algebra: Matrices, Determinants, Eigenvalues",
      "Calculus: Limits, Continuity, Differentiation, Integration",
      "Probability and Statistics: Mean, Variance, Probability Distributions",
      "Numerical Methods: Solutions of Equations, Interpolation",
      "Vector Analysis: Gradient, Divergence, Curl",
      "Differential Equations: First Order, Higher Order"
    ];
    // Initialize data from localStorage
    let tasks = JSON.parse(localStorage.getItem('gateTasks')) || [];
    let topicStatuses = JSON.parse(localStorage.getItem('gateTopicStatuses')) || {};
    let selectedPapers = JSON.parse(localStorage.getItem('selectedPapers')) || [];
    let isDarkMode = JSON.parse(localStorage.getItem('darkMode')) || false;
    // Apply dark mode if enabled
    if (isDarkMode) {
      document.body.classList.add('dark-mode');
      document.getElementById('darkModeButton').textContent = 'Disable Night Mode';
    } else {
      document.getElementById('darkModeButton').textContent = 'Enable Night Mode';
    }
    // Populate paper selection dropdowns
    const paper1Select = document.getElementById('paper1');
    const paper2Select = document.getElementById('paper2');
    Object.keys(syllabus).filter(p => p !== 'GA').forEach(paper => {
      const option1 = document.createElement('option');
      option1.value = paper;
      option1.textContent = paper;
      paper1Select.appendChild(option1);
      const option2 = document.createElement('option');
      option2.value = paper;
      option2.textContent = paper;
      paper2Select.appendChild(option2);
    });
    // Toggle paper input visibility
    function togglePaperInputs() {
      const numPapers = document.getElementById('numPapers').value;
      document.getElementById('paper2Input').classList.toggle('hidden', numPapers === '1');
      updateSecondaryPaperOptions();
    }
    // Update secondary paper options based on primary paper
    function updateSecondaryPaperOptions() {
      const primaryPaper = document.getElementById('paper1').value;
      const paper2Select = document.getElementById('paper2');
      paper2Select.innerHTML = '<option value="">Select Secondary Paper</option>';
      allowedCombinations[primaryPaper].forEach(paper => {
        const option = document.createElement('option');
        option.value = paper;
        option.textContent = paper;
        paper2Select.appendChild(option);
      });
    }
    // Save paper selection
    function savePaperSelection() {
      const numPapers = document.getElementById('numPapers').value;
      const paper1 = document.getElementById('paper1').value;
      const paper2 = document.getElementById('paper2').value;
      if (!paper1 || (numPapers === '2' && !paper2)) {
        alert('Please select all required papers.');
        return;
      }
      if (numPapers === '2' && !allowedCombinations[paper1].includes(paper2)) {
        alert('Invalid paper combination. Please select an allowed secondary paper.');
        return;
      }
      selectedPapers = numPapers === '1' ? [paper1, 'GA'] : [paper1, paper2, 'GA'];
      localStorage.setItem('selectedPapers', JSON.stringify(selectedPapers));
      // Initialize topic statuses for selected papers
      selectedPapers.forEach(paper => {
        if (!topicStatuses[paper]) {
          topicStatuses[paper] = syllabus[paper].map(topic => ({ topic, status: 'Not Started', difficulty: 'Moderate', notes: '' }));
        }
      });
      localStorage.setItem('gateTopicStatuses', JSON.stringify(topicStatuses));
      document.getElementById('paperModal').style.display = 'none';
      updateUI();
    }
    // Function to initiate reset with two-step confirmation
    function initiateReset() {
      if (confirm('Are you sure you want to reset all data?')) {
        if (confirm('This will reset all statuses, difficulties, notes, tasks, paper selection, and dark mode settings. Proceed?')) {
          resetData();
        }
      }
    }
    // Function to reset all data
    function resetData() {
      localStorage.removeItem('gateTasks');
      localStorage.removeItem('gateTopicStatuses');
      localStorage.removeItem('selectedPapers');
      localStorage.removeItem('darkMode');
      tasks = [];
      topicStatuses = {};
      selectedPapers = [];
      isDarkMode = false;
      localStorage.setItem('darkMode', JSON.stringify(isDarkMode));
      document.body.classList.remove('dark-mode');
      document.getElementById('darkModeButton').textContent = 'Enable Night Mode';
      document.getElementById('paperModal').style.display = 'flex';
      updateUI();
    }
    // Function to toggle dark mode
    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
      isDarkMode = document.body.classList.contains('dark-mode');
      document.getElementById('darkModeButton').textContent = isDarkMode ? 'Disable Night Mode' : 'Enable Night Mode';
      localStorage.setItem('darkMode', JSON.stringify(isDarkMode));
    }
    // Function to update topic status
    function updateTopicStatus(subject, topic, status) {
      topicStatuses[subject] = topicStatuses[subject].map(item =>
        item.topic === topic ? { ...item, status } : item
      );
      localStorage.setItem('gateTopicStatuses', JSON.stringify(topicStatuses));
      updateTopicTables();
      updateProgress();
      updateCharts();
    }
    // Function to update topic difficulty
    function updateTopicDifficulty(subject, topic, difficulty) {
      topicStatuses[subject] = topicStatuses[subject].map(item =>
        item.topic === topic ? { ...item, difficulty } : item
      );
      localStorage.setItem('gateTopicStatuses', JSON.stringify(topicStatuses));
    }
    // Function to update topic notes
    function updateTopicNotes(subject, topic, notes) {
      topicStatuses[subject] = topicStatuses[subject].map(item =>
        item.topic === topic ? { ...item, notes } : item
      );
      localStorage.setItem('gateTopicStatuses', JSON.stringify(topicStatuses));
    }
    // Function to update topic tables
    function updateTopicTables() {
      const topicTables = document.getElementById('topicTables');
      topicTables.innerHTML = '';
      selectedPapers.forEach(subject => {
        const div = document.createElement('div');
        div.innerHTML = `
          <h3 class="text-lg font-medium text-${subject === 'GA' ? 'yellow' : subject === selectedPapers[0] ? 'blue' : 'green'}-600">${subject}</h3>
          <div class="topic-table">
            <table class="w-full border-collapse">
              <thead>
                <tr class="bg-gray-200">
                  <th class="border p-2">Topic</th>
                  <th class="border p-2">Tag</th>
                  <th class="border p-2">Difficulty</th>
                  <th class="border p-2">Status</th>
                  <th class="border p-2">Notes</th>
                </tr>
              </thead>
              <tbody id="${subject.toLowerCase()}Topics"></tbody>
            </table>
          </div>
        `;
        topicTables.appendChild(div);
        const tableBody = document.getElementById(`${subject.toLowerCase()}Topics`);
        topicStatuses[subject].forEach(item => {
          const isCommon = commonTopics.includes(item.topic);
          const row = document.createElement('tr');
          row.innerHTML = `
            <td class="border p-2">${item.topic}</td>
            <td class="border p-2">${isCommon ? '<span class="bg-purple-200 text-purple-800 px-2 py-1 rounded">Common</span>' : ''}</td>
            <td class="border p-2">
              <select onchange="updateTopicDifficulty('${subject}', '${item.topic}', this.value)" class="p-1 border rounded-md w-full">
                <option value="Easy" ${item.difficulty === "Easy" ? "selected" : ""}>Easy</option>
                <option value="Moderate" ${item.difficulty === "Moderate" ? "selected" : ""}>Moderate</option>
                <option value="Hard" ${item.difficulty === "Hard" ? "selected" : ""}>Hard</option>
              </select>
            </td>
            <td class="border p-2">
              <select onchange="updateTopicStatus('${subject}', '${item.topic}', this.value)" class="p-1 border rounded-md w-full">
                <option value="Not Started" ${item.status === "Not Started" ? "selected" : ""}>Not Started</option>
                <option value="In Progress" ${item.status === "In Progress" ? "selected" : ""}>In Progress</option>
                <option value="Completed" ${item.status === "Completed" ? "selected" : ""}>Completed</option>
              </select>
            </td>
            <td class="border p-2">
              <textarea onchange="updateTopicNotes('${subject}', '${item.topic}', this.value)" class="p-1 border rounded-md w-full" rows="2" placeholder="Add notes (e.g., resources, doubts)">${item.notes}</textarea>
            </td>
          `;
          tableBody.appendChild(row);
        });
      });
    }
    // Function to add a new task
    function addTask() {
      const taskDate = document.getElementById('taskDate').value;
      const subject = document.getElementById('subject').value;
      const topic = document.getElementById('topic').value;
      const status = document.getElementById('status').value;
      const notes = document.getElementById('notes').value;
      if (!taskDate || !topic || !subject) {
        alert('Please fill in Date, Subject, and Topic.');
        return;
      }
      const task = { id: Date.now(), date: taskDate, subject, topic, status, notes };
      tasks.push(task);
      localStorage.setItem('gateTasks', JSON.stringify(tasks));
      updateTaskTable();
      clearForm();
      alert('Task added successfully!');
    }
    // Function to clear form inputs
    function clearForm() {
      document.getElementById('taskDate').value = new Date().toISOString().split('T')[0];
      document.getElementById('subject').value = selectedPapers[0] || 'EC';
      document.getElementById('topic').value = '';
      document.getElementById('status').value = 'Not Started';
      document.getElementById('notes').value = '';
    }
    // Function to delete a task
    function deleteTask(id) {
      tasks = tasks.filter(task => task.id !== id);
      localStorage.setItem('gateTasks', JSON.stringify(tasks));
      updateTaskTable();
    }
    // Function to update task table
    function updateTaskTable() {
      const tableBody = document.getElementById('taskTable');
      tableBody.innerHTML = '';
      tasks.sort((a, b) => new Date(b.date) - new Date(a.date));
      tasks.forEach(task => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td class="border p-2">${task.date}</td>
          <td class="border p-2">${task.subject}</td>
          <td class="border p-2">${task.topic}</td>
          <td class="border p-2">${task.status}</td>
          <td class="border p-2">${task.notes}</td>
          <td class="border p-2">
            <button onclick="deleteTask(${task.id})" class="text-red-600 hover:underline">Delete</button>
          </td>
        `;
        tableBody.appendChild(row);
      });
    }
    // Function to update progress percentages
    function updateProgress() {
      const progress = {};
      selectedPapers.forEach(subject => {
        const totalTopics = topicStatuses[subject].length;
        const completedTopics = topicStatuses[subject].filter(item => item.status === 'Completed').length;
        const prog = totalTopics > 0 ? Math.round((completedTopics / totalTopics) * 100) : 0;
        progress[subject] = prog;
      });
      const progressSummary = document.getElementById('progressSummary');
      progressSummary.innerHTML = '';
      selectedPapers.forEach(subject => {
        const div = document.createElement('div');
        div.className = `bg-${subject === 'GA' ? 'yellow' : subject === selectedPapers[0] ? 'blue' : 'green'}-100 p-4 rounded-md`;
        div.innerHTML = `
          <h3 class="font-medium">${subject} Completion</h3>
          <p id="${subject.toLowerCase()}Progress" class="text-lg">${progress[subject]}%</p>
        `;
        progressSummary.appendChild(div);
      });
      return progress;
    }
    // Function to update charts
    function updateCharts() {
      const progress = updateProgress();
      const chartContainer = document.getElementById('chartContainer');
      chartContainer.innerHTML = '';
      selectedPapers.forEach(subject => {
        const div = document.createElement('div');
        div.className = 'chart-container';
        div.innerHTML = `<canvas id="${subject.toLowerCase()}Chart" width="200" height="100"></canvas>`;
        chartContainer.appendChild(div);
        const ctx = document.getElementById(`${subject.toLowerCase()}Chart`).getContext('2d');
        if (window[`${subject}Chart`]) {
          window[`${subject}Chart`].destroy();
        }
        window[`${subject}Chart`] = new Chart(ctx, {
          type: 'doughnut',
          data: {
            labels: ['Completed', 'Remaining'],
            datasets: [{
              data: [progress[subject], 100 - progress[subject]],
              backgroundColor: ['#36a2eb', '#e5e7eb'],
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            animation: {
              duration: 1000,
              easing: 'easeInOutQuad'
            },
            plugins: {
              legend: { position: 'top', labels: { font: { size: 10 } } },
              title: { display: true, text: `${subject} Progress`, font: { size: 12 } }
            }
          }
        });
      });
    }
    // Function to update entire UI
    function updateUI() {
      if (!selectedPapers.length) {
        document.getElementById('paperModal').style.display = 'flex';
        return;
      }
      document.getElementById('trackerTitle').textContent = `GATE 2026 Progress Tracker (${selectedPapers.filter(p => p !== 'GA').join(' & ')})`;
      const subjectSelect = document.getElementById('subject');
      subjectSelect.innerHTML = '';
      selectedPapers.forEach(paper => {
        const option = document.createElement('option');
        option.value = paper;
        option.textContent = paper;
        subjectSelect.appendChild(option);
      });
      updateTopicTables();
      updateTaskTable();
      updateCharts();
      document.getElementById('taskDate').value = new Date().toISOString().split('T')[0];
    }
    // Initialize
    paper1Select.addEventListener('change', updateSecondaryPaperOptions);
    updateUI();
  </script>
</body>
</html>